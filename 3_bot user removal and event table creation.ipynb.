{"cells":[{"cell_type":"markdown","source":["## Get user id list and count"],"metadata":{}},{"cell_type":"code","source":["import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":2},{"cell_type":"code","source":["#df = pd.read_csv('dfbs/data/uid_count.csv',sep='\\s+', names=['count','uid'])\nuid_count = spark.table(\"uid_count\")\n#uid_count is a pyspark.sql.dataframe.DataFrame object\nuid_count.printSchema()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">root\n-- count: string (nullable = true)\n-- uid: string (nullable = true)\n\n</div>"]}}],"execution_count":3},{"cell_type":"code","source":["#added -1 as uid for first row (was empty)\nuid_count.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+---------+\n  count|      uid|\n+-------+---------+\n      2|       -1|\n1167848|        0|\n      2|100002491|\n     56|100052111|\n      9|100071797|\n     17|100077577|\n    136|100077978|\n   1346|100087237|\n     84|100102865|\n      4|100107633|\n    106|100139083|\n    484|100157378|\n      1|100202448|\n    270|100202712|\n     16|100223381|\n      4|100227405|\n     22|100245413|\n      3|100275411|\n     16|100328129|\n      2|100362850|\n+-------+---------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":4},{"cell_type":"code","source":["uid_count.describe().show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+------------------+--------------------+\nsummary|             count|                 uid|\n+-------+------------------+--------------------+\n  count|            594735|              594735|\n   mean|246.05254104769352|1.6736249497856355E8|\n stddev|15266.624521548498|1.0473662049735466E7|\n    min|                 1|                  -1|\n    max|               999|            99997797|\n+-------+------------------+--------------------+\n\n</div>"]}}],"execution_count":5},{"cell_type":"markdown","source":["## Remove bots and outliers"],"metadata":{}},{"cell_type":"code","source":["# We use matplotlib for plotting\nimport matplotlib.pyplot as plt\n\n# This statement allow to display plot without asking to\n%matplotlib inline"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">%matplotlib inline is not supported in Databricks.\nYou can display matplotlib figures using display(). For an example, see https://docs.databricks.com/user-guide/visualizations/matplotlib-and-ggplot.html\n</div>"]}}],"execution_count":7},{"cell_type":"code","source":["#use display to show the plot\nfrom pyspark.sql.functions import log10 as log\ndisplay(uid_count.select(log('count')))\n#choose 'Histogram' in the plot options.\n#This is only for first 1000 rows."],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>LOG10(count)</th></tr></thead><tbody><tr><td>0.3010299956639812</td></tr><tr><td>6.067386321323493</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.7481880270062005</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>2.1335389083702174</td></tr><tr><td>3.1290450598879582</td></tr><tr><td>1.9242792860618816</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>2.0253058652647704</td></tr><tr><td>2.6848453616444123</td></tr><tr><td>0.0</td></tr><tr><td>2.4313637641589874</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.3424226808222062</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.6138418218760693</td></tr><tr><td>2.0043213737826426</td></tr><tr><td>0.0</td></tr><tr><td>3.0681858617461617</td></tr><tr><td>1.414973347970818</td></tr><tr><td>2.9813655090785445</td></tr><tr><td>1.3010299956639813</td></tr><tr><td>2.8195439355418688</td></tr><tr><td>1.6812412373755872</td></tr><tr><td>1.7708520116421442</td></tr><tr><td>2.5224442335063197</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>1.9344984512435677</td></tr><tr><td>2.5998830720736876</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>1.954242509439325</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.9344984512435677</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>2.737987326333431</td></tr><tr><td>3.003029470553618</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>3.3029799367482493</td></tr><tr><td>2.537819095073274</td></tr><tr><td>0.0</td></tr><tr><td>2.561101383649056</td></tr><tr><td>2.1492191126553797</td></tr><tr><td>1.6434526764861874</td></tr><tr><td>3.739255803268511</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>2.5477747053878224</td></tr><tr><td>2.3891660843645326</td></tr><tr><td>0.0</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>2.550228353055094</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>2.6503075231319366</td></tr><tr><td>2.5428254269591797</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>1.806179973983887</td></tr><tr><td>1.0</td></tr><tr><td>2.0170333392987803</td></tr><tr><td>2.6503075231319366</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>3.707910665713106</td></tr><tr><td>2.5774917998372255</td></tr><tr><td>3.469232742506612</td></tr><tr><td>1.8750612633917</td></tr><tr><td>2.167317334748176</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.0</td></tr><tr><td>1.414973347970818</td></tr><tr><td>2.6242820958356683</td></tr><tr><td>1.591064607026499</td></tr><tr><td>3.1271047983648077</td></tr><tr><td>0.0</td></tr><tr><td>0.0</td></tr><tr><td>2.2648178230095364</td></tr><tr><td>2.895422546039408</td></tr><tr><td>1.7558748556724915</td></tr><tr><td>1.7781512503836436</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>2.858537197569639</td></tr><tr><td>2.7708520116421442</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.7126497016272113</td></tr><tr><td>2.808885867359812</td></tr><tr><td>2.4099331233312946</td></tr><tr><td>0.0</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>3.003029470553618</td></tr><tr><td>2.307496037913213</td></tr><tr><td>1.414973347970818</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.0</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.012837224705172</td></tr><tr><td>2.7067177823367587</td></tr><tr><td>2.9003671286564705</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>1.7708520116421442</td></tr><tr><td>2.3521825181113627</td></tr><tr><td>1.7160033436347992</td></tr><tr><td>3.577261953585815</td></tr><tr><td>1.6720978579357175</td></tr><tr><td>1.845098040014257</td></tr><tr><td>1.0</td></tr><tr><td>2.931457870689005</td></tr><tr><td>2.720159303405957</td></tr><tr><td>2.413299764081252</td></tr><tr><td>1.919078092376074</td></tr><tr><td>3.2624510897304293</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.6020599913279623</td></tr><tr><td>2.762678563727436</td></tr><tr><td>3.2898118391176214</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.2405492482826</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.3222192947339193</td></tr><tr><td>0.0</td></tr><tr><td>2.595496221825574</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.2405492482826</td></tr><tr><td>1.3424226808222062</td></tr><tr><td>1.3010299956639813</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>2.413299764081252</td></tr><tr><td>2.9459607035775686</td></tr><tr><td>1.414973347970818</td></tr><tr><td>0.0</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>0.0</td></tr><tr><td>2.603144372620182</td></tr><tr><td>3.162564406523019</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>0.0</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.3222192947339193</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>1.3979400086720377</td></tr><tr><td>2.7403626894942437</td></tr><tr><td>2.760422483423212</td></tr><tr><td>2.499687082618404</td></tr><tr><td>3.082066934285113</td></tr><tr><td>2.494154594018443</td></tr><tr><td>2.0211892990699383</td></tr><tr><td>2.5477747053878224</td></tr><tr><td>0.0</td></tr><tr><td>0.0</td></tr><tr><td>2.537819095073274</td></tr><tr><td>1.806179973983887</td></tr><tr><td>2.519827993775719</td></tr><tr><td>1.5185139398778875</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>2.103803720955957</td></tr><tr><td>2.6711728427150834</td></tr><tr><td>1.9822712330395684</td></tr><tr><td>2.3560258571931225</td></tr><tr><td>2.3636119798921444</td></tr><tr><td>2.9978230807457256</td></tr><tr><td>1.4913616938342726</td></tr><tr><td>3.1583624920952498</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.3979400086720377</td></tr><tr><td>1.3222192947339193</td></tr><tr><td>3.298853076409707</td></tr><tr><td>1.0</td></tr><tr><td>1.7160033436347992</td></tr><tr><td>1.9344984512435677</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.4771212547196624</td></tr><tr><td>1.8260748027008264</td></tr><tr><td>3.519827993775719</td></tr><tr><td>1.568201724066995</td></tr><tr><td>0.0</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>3.129689892199301</td></tr><tr><td>1.9444826721501687</td></tr><tr><td>2.1958996524092336</td></tr><tr><td>1.4913616938342726</td></tr><tr><td>2.649334858712142</td></tr><tr><td>2.7505083948513462</td></tr><tr><td>1.99563519459755</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>3.208710019906401</td></tr><tr><td>1.0</td></tr><tr><td>1.505149978319906</td></tr><tr><td>2.513217600067939</td></tr><tr><td>1.568201724066995</td></tr><tr><td>0.0</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>3.323870606540509</td></tr><tr><td>0.0</td></tr><tr><td>1.7558748556724915</td></tr><tr><td>2.2068258760318495</td></tr><tr><td>2.1583624920952498</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>2.8965262174895554</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.863322860120456</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.568201724066995</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>0.0</td></tr><tr><td>1.8129133566428555</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.954242509439325</td></tr><tr><td>3.495821753385906</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>3.3769417571467586</td></tr><tr><td>2.9894498176666917</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.0</td></tr><tr><td>2.278753600952829</td></tr><tr><td>2.1760912590556813</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.8195439355418688</td></tr><tr><td>0.0</td></tr><tr><td>1.806179973983887</td></tr><tr><td>3.002166061756508</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.6232492903979006</td></tr><tr><td>1.792391689498254</td></tr><tr><td>2.0293837776852097</td></tr><tr><td>0.0</td></tr><tr><td>2.3560258571931225</td></tr><tr><td>1.6232492903979006</td></tr><tr><td>6.372354239029433</td></tr><tr><td>3.1734776434529945</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.884795363948981</td></tr><tr><td>2.214843848047698</td></tr><tr><td>1.8920946026904804</td></tr><tr><td>1.5563025007672873</td></tr><tr><td>2.41161970596323</td></tr><tr><td>1.6232492903979006</td></tr><tr><td>2.9858753573083936</td></tr><tr><td>2.9479236198317262</td></tr><tr><td>1.968482948553935</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>2.958085848521085</td></tr><tr><td>0.0</td></tr><tr><td>1.6720978579357175</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>0.0</td></tr><tr><td>2.416640507338281</td></tr><tr><td>1.9493900066449128</td></tr><tr><td>2.1931245983544616</td></tr><tr><td>1.6532125137753437</td></tr><tr><td>1.9822712330395684</td></tr><tr><td>2.8767949762007006</td></tr><tr><td>2.1522883443830563</td></tr><tr><td>1.505149978319906</td></tr><tr><td>1.6127838567197355</td></tr><tr><td>2.100370545117563</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>3.530967681571915</td></tr><tr><td>2.359835482339888</td></tr><tr><td>2.0791812460476247</td></tr><tr><td>1.9294189257142926</td></tr><tr><td>2.2041199826559246</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.0</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>1.505149978319906</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.8692317197309762</td></tr><tr><td>2.496929648073215</td></tr><tr><td>2.7902851640332416</td></tr><tr><td>2.6972293427597176</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>3.0770043267933502</td></tr><tr><td>2.0043213737826426</td></tr><tr><td>1.8750612633917</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.0</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.662757831681574</td></tr><tr><td>2.784617292632875</td></tr><tr><td>0.0</td></tr><tr><td>2.5024271199844326</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.287801729930226</td></tr><tr><td>0.0</td></tr><tr><td>0.0</td></tr><tr><td>2.66838591669</td></tr><tr><td>1.255272505103306</td></tr><tr><td>1.146128035678238</td></tr><tr><td>2.6242820958356683</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.0</td></tr><tr><td>2.285557309007774</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>2.0681858617461617</td></tr><tr><td>0.0</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>0.0</td></tr><tr><td>0.0</td></tr><tr><td>2.2380461031287955</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>2.534026106056135</td></tr><tr><td>3.269746373130767</td></tr><tr><td>1.146128035678238</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>2.0718820073061255</td></tr><tr><td>2.5171958979499744</td></tr><tr><td>3.0199466816788423</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>2.303196057420489</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.9395192526186187</td></tr><tr><td>2.357934847000454</td></tr><tr><td>2.012837224705172</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.568201724066995</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.3979400086720377</td></tr><tr><td>1.8388490907372552</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>3.083860800866573</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>2.3961993470957363</td></tr><tr><td>2.6127838567197355</td></tr><tr><td>3.3376588910261424</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>3.5040628826786917</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.7363965022766426</td></tr><tr><td>2.840106094456758</td></tr><tr><td>2.8920946026904804</td></tr><tr><td>1.845098040014257</td></tr><tr><td>2.6148972160331345</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>0.0</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>1.919078092376074</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.146128035678238</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.863322860120456</td></tr><tr><td>1.7075701760979363</td></tr><tr><td>1.9294189257142926</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>1.505149978319906</td></tr><tr><td>1.7481880270062005</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.3010299956639813</td></tr><tr><td>2.247973266361807</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>2.2600713879850747</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>2.5440680443502757</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>2.7101173651118162</td></tr><tr><td>1.6812412373755872</td></tr><tr><td>2.4771212547196626</td></tr><tr><td>2.27415784926368</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>3.5174598265402324</td></tr><tr><td>1.9395192526186185</td></tr><tr><td>2.717670503002262</td></tr><tr><td>3.2489536154957075</td></tr><tr><td>2.9921114877869495</td></tr><tr><td>1.7323937598229686</td></tr><tr><td>1.6232492903979006</td></tr><tr><td>2.3364597338485296</td></tr><tr><td>1.7160033436347992</td></tr><tr><td>0.0</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>2.4471580313422194</td></tr><tr><td>1.591064607026499</td></tr><tr><td>1.3222192947339193</td></tr><tr><td>1.6532125137753437</td></tr><tr><td>1.0</td></tr><tr><td>2.0681858617461617</td></tr><tr><td>1.845098040014257</td></tr><tr><td>2.615950051656401</td></tr><tr><td>2.0681858617461617</td></tr><tr><td>1.7634279935629373</td></tr><tr><td>1.5185139398778875</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>0.0</td></tr><tr><td>3.5260806918020298</td></tr><tr><td>2.6848453616444123</td></tr><tr><td>3.016615547557177</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>0.0</td></tr><tr><td>1.9444826721501687</td></tr><tr><td>1.6532125137753437</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>2.361727836017593</td></tr><tr><td>3.121887985103681</td></tr><tr><td>1.4771212547196624</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>1.6127838567197355</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.662757831681574</td></tr><tr><td>1.8808135922807914</td></tr><tr><td>1.4313637641589874</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.8920946026904804</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>3.3042750504771283</td></tr><tr><td>2.905256048748451</td></tr><tr><td>1.9912260756924949</td></tr><tr><td>1.505149978319906</td></tr><tr><td>1.3222192947339193</td></tr><tr><td>1.4771212547196624</td></tr><tr><td>1.568201724066995</td></tr><tr><td>1.8920946026904804</td></tr><tr><td>2.385606273598312</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>3.218010042984363</td></tr><tr><td>1.0</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.8692317197309762</td></tr><tr><td>2.6711728427150834</td></tr><tr><td>1.591064607026499</td></tr><tr><td>2.6085260335771943</td></tr><tr><td>2.403120521175818</td></tr><tr><td>2.2624510897304293</td></tr><tr><td>3.703978825008386</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>2.0170333392987803</td></tr><tr><td>0.0</td></tr><tr><td>2.1398790864012365</td></tr><tr><td>0.0</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>2.2671717284030137</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.7481880270062005</td></tr><tr><td>2.3541084391474008</td></tr><tr><td>2.6324572921847245</td></tr><tr><td>1.380211241711606</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>2.0755469613925306</td></tr><tr><td>3.4483971034577676</td></tr><tr><td>2.507855871695831</td></tr><tr><td>2.0644579892269186</td></tr><tr><td>1.6020599913279623</td></tr><tr><td>1.0</td></tr><tr><td>1.8920946026904804</td></tr><tr><td>3.2412973871099933</td></tr><tr><td>1.9344984512435677</td></tr><tr><td>2.437750562820388</td></tr><tr><td>2.3521825181113627</td></tr><tr><td>2.093421685162235</td></tr><tr><td>2.230448921378274</td></tr><tr><td>2.2405492482826</td></tr><tr><td>1.9822712330395684</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.505149978319906</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.187520720836463</td></tr><tr><td>2.2810333672477277</td></tr><tr><td>2.3783979009481375</td></tr><tr><td>3.1547282074401557</td></tr><tr><td>2.920123326290724</td></tr><tr><td>2.8506462351830666</td></tr><tr><td>3.0780941504064105</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.5728716022004803</td></tr><tr><td>2.603144372620182</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.4771212547196624</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.7481880270062005</td></tr><tr><td>1.792391689498254</td></tr><tr><td>0.0</td></tr><tr><td>0.0</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>2.842609239610562</td></tr><tr><td>1.146128035678238</td></tr><tr><td>2.584331224367531</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>3.2600713879850747</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.0</td></tr><tr><td>2.967547976218862</td></tr><tr><td>2.5514499979728753</td></tr><tr><td>2.146128035678238</td></tr><tr><td>1.6812412373755872</td></tr><tr><td>2.61066016308988</td></tr><tr><td>2.432969290874406</td></tr><tr><td>2.187520720836463</td></tr><tr><td>1.4771212547196624</td></tr><tr><td>1.5314789170422551</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>2.462397997898956</td></tr><tr><td>2.3096301674258988</td></tr><tr><td>1.8976270912904414</td></tr><tr><td>1.3424226808222062</td></tr><tr><td>1.7853298350107671</td></tr><tr><td>3.6875289612146345</td></tr><tr><td>1.380211241711606</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>1.5314789170422551</td></tr><tr><td>2.6989700043360187</td></tr><tr><td>2.824125833916549</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>1.6901960800285136</td></tr><tr><td>2.1986570869544226</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.568201724066995</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>2.0969100130080562</td></tr><tr><td>1.146128035678238</td></tr><tr><td>1.6901960800285136</td></tr><tr><td>1.863322860120456</td></tr><tr><td>2.884795363948981</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.7634279935629373</td></tr><tr><td>2.0755469613925306</td></tr><tr><td>2.2355284469075487</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>3.4058583993176366</td></tr><tr><td>2.9731278535996988</td></tr><tr><td>3.3525683861793087</td></tr><tr><td>1.4913616938342726</td></tr><tr><td>2.298853076409707</td></tr><tr><td>3.1492191126553797</td></tr><tr><td>1.7708520116421442</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>1.3010299956639813</td></tr><tr><td>1.9084850188786497</td></tr><tr><td>1.7323937598229686</td></tr><tr><td>0.0</td></tr><tr><td>1.505149978319906</td></tr><tr><td>1.7558748556724915</td></tr><tr><td>2.167317334748176</td></tr><tr><td>2.4983105537896004</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>2.385606273598312</td></tr><tr><td>2.225309281725863</td></tr><tr><td>1.9912260756924949</td></tr><tr><td>3.1922886125681202</td></tr><tr><td>2.890979596989689</td></tr><tr><td>2.2528530309798933</td></tr><tr><td>1.0</td></tr><tr><td>3.229681842317676</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>1.505149978319906</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.6273658565927325</td></tr><tr><td>2.568201724066995</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>3.137986732723532</td></tr><tr><td>0.0</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.5327543789924976</td></tr><tr><td>2.161368002234975</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.3979400086720377</td></tr><tr><td>1.7634279935629373</td></tr><tr><td>2.9390197764486663</td></tr><tr><td>2.1335389083702174</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>2.3783979009481375</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>1.9822712330395684</td></tr><tr><td>2.762678563727436</td></tr><tr><td>2.645422269349092</td></tr><tr><td>3.419625360887743</td></tr><tr><td>2.374748346010104</td></tr><tr><td>2.3944516808262164</td></tr><tr><td>2.7664128471123997</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>3.3224260524059526</td></tr><tr><td>0.0</td></tr><tr><td>1.9444826721501687</td></tr><tr><td>1.6434526764861874</td></tr><tr><td>2.424881636631067</td></tr><tr><td>2.1492191126553797</td></tr><tr><td>2.0681858617461617</td></tr><tr><td>3.591621038213319</td></tr><tr><td>2.4608978427565478</td></tr><tr><td>2.1760912590556813</td></tr><tr><td>3.3226327116922234</td></tr><tr><td>2.0681858617461617</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>3.0394141191761372</td></tr><tr><td>2.9694159123539814</td></tr><tr><td>2.6138418218760693</td></tr><tr><td>1.9084850188786497</td></tr><tr><td>2.037426497940624</td></tr><tr><td>2.4955443375464483</td></tr><tr><td>0.0</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>0.0</td></tr><tr><td>2.012837224705172</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>0.0</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>2.496929648073215</td></tr><tr><td>2.9474337218870508</td></tr><tr><td>2.298853076409707</td></tr><tr><td>1.6901960800285136</td></tr><tr><td>2.2095150145426308</td></tr><tr><td>1.414973347970818</td></tr><tr><td>2.2648178230095364</td></tr><tr><td>3.244029589030022</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>0.0</td></tr><tr><td>2.2624510897304293</td></tr><tr><td>1.99563519459755</td></tr><tr><td>3.1383026981662816</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>2.7810369386211318</td></tr><tr><td>2.311753861055754</td></tr><tr><td>2.9722028383790646</td></tr><tr><td>2.552668216112193</td></tr><tr><td>3.654369090975286</td></tr><tr><td>2.537819095073274</td></tr><tr><td>2.4668676203541096</td></tr><tr><td>1.9777236052888478</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>1.6989700043360187</td></tr><tr><td>1.5185139398778875</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>1.5563025007672873</td></tr><tr><td>2.392696953259666</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.7867514221455614</td></tr><tr><td>2.27415784926368</td></tr><tr><td>2.510545010206612</td></tr><tr><td>3.5796692935547205</td></tr><tr><td>0.0</td></tr><tr><td>1.863322860120456</td></tr><tr><td>1.9084850188786497</td></tr><tr><td>2.146128035678238</td></tr><tr><td>1.6720978579357175</td></tr><tr><td>0.0</td></tr><tr><td>3.0429690733931802</td></tr><tr><td>3.6291036501771363</td></tr><tr><td>1.8808135922807914</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>0.0</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>0.0</td></tr><tr><td>2.3654879848909</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.346352974450639</td></tr><tr><td>0.0</td></tr><tr><td>1.380211241711606</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.9849771264154934</td></tr><tr><td>2.2329961103921536</td></tr><tr><td>2.2600713879850747</td></tr><tr><td>2.130333768495006</td></tr><tr><td>2.598790506763115</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>2.7649229846498886</td></tr><tr><td>1.5797835966168101</td></tr><tr><td>1.7708520116421442</td></tr><tr><td>2.2430380486862944</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.1903316981702914</td></tr><tr><td>2.6748611407378116</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>2.3979400086720375</td></tr><tr><td>2.0791812460476247</td></tr><tr><td>2.5185139398778875</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>3.185825359612962</td></tr><tr><td>1.724275869600789</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>2.658964842664435</td></tr><tr><td>2.3560258571931225</td></tr><tr><td>2.986323777050765</td></tr><tr><td>2.100370545117563</td></tr><tr><td>2.3729120029701067</td></tr><tr><td>2.100370545117563</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>2.5352941200427703</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.4313637641589874</td></tr><tr><td>1.505149978319906</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.146128035678238</td></tr><tr><td>1.5440680443502757</td></tr><tr><td>1.414973347970818</td></tr><tr><td>2.8260748027008264</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.56702636615906</td></tr><tr><td>2.7795964912578244</td></tr><tr><td>3.2237554536572413</td></tr><tr><td>2.9444826721501687</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.552668216112193</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>1.8260748027008264</td></tr><tr><td>3.520483532740792</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>1.9493900066449128</td></tr><tr><td>2.926342446625655</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>2.3096301674258988</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>0.0</td></tr><tr><td>3.024895960107485</td></tr><tr><td>2.800717078282385</td></tr><tr><td>1.0</td></tr><tr><td>1.505149978319906</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.5563025007672873</td></tr><tr><td>2.0569048513364727</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>1.4913616938342726</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.9242792860618816</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>1.0</td></tr><tr><td>1.2787536009528289</td></tr><tr><td>2.8363241157067516</td></tr><tr><td>1.9395192526186185</td></tr><tr><td>2.0863598306747484</td></tr><tr><td>1.462397997898956</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.146128035678238</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.8388490907372552</td></tr><tr><td>3.0330214446829107</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>3.3459615418131414</td></tr><tr><td>0.0</td></tr><tr><td>1.2041199826559248</td></tr><tr><td>3.127428777851599</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.5024271199844326</td></tr><tr><td>1.0</td></tr><tr><td>2.8609366207000937</td></tr><tr><td>1.380211241711606</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.255272505103306</td></tr><tr><td>3.802636918082811</td></tr><tr><td>0.0</td></tr><tr><td>2.6009728956867484</td></tr><tr><td>2.27415784926368</td></tr><tr><td>2.7427251313046983</td></tr><tr><td>2.741939077729199</td></tr><tr><td>2.1789769472931693</td></tr><tr><td>0.0</td></tr><tr><td>2.103803720955957</td></tr><tr><td>2.4668676203541096</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>2.4183012913197452</td></tr><tr><td>0.0</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.7708520116421442</td></tr><tr><td>2.247973266361807</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>2.8115750058705933</td></tr><tr><td>2.3710678622717363</td></tr><tr><td>2.499687082618404</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.7715874808812555</td></tr><tr><td>2.5599066250361124</td></tr><tr><td>0.9542425094393249</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.754348335711019</td></tr><tr><td>2.3654879848909</td></tr><tr><td>1.3424226808222062</td></tr><tr><td>3.060320028688285</td></tr><tr><td>3.307923703611882</td></tr><tr><td>1.4913616938342726</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>1.8976270912904414</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>1.7403626894942439</td></tr><tr><td>2.582063362911709</td></tr><tr><td>2.4955443375464483</td></tr><tr><td>3.5732198271144218</td></tr><tr><td>1.7160033436347992</td></tr><tr><td>1.9493900066449128</td></tr><tr><td>2.0718820073061255</td></tr><tr><td>2.8609366207000937</td></tr><tr><td>1.968482948553935</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>2.0969100130080562</td></tr><tr><td>1.8129133566428555</td></tr><tr><td>2.499687082618404</td></tr><tr><td>2.0681858617461617</td></tr><tr><td>2.311753861055754</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.278753600952829</td></tr><tr><td>1.2304489213782739</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>1.380211241711606</td></tr><tr><td>3.329194415088451</td></tr><tr><td>1.5440680443502757</td></tr><tr><td>1.7634279935629373</td></tr><tr><td>2.428134794028789</td></tr><tr><td>1.6901960800285136</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.0</td></tr><tr><td>2.5622928644564746</td></tr><tr><td>2.1702617153949575</td></tr><tr><td>0.8450980400142568</td></tr><tr><td>3.4734869700645685</td></tr><tr><td>2.3138672203691533</td></tr><tr><td>0.0</td></tr><tr><td>1.146128035678238</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.9444826721501687</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>3.089905111439398</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>1.5185139398778875</td></tr><tr><td>2.5998830720736876</td></tr><tr><td>1.792391689498254</td></tr><tr><td>2.225309281725863</td></tr><tr><td>1.3010299956639813</td></tr><tr><td>1.5440680443502757</td></tr><tr><td>1.146128035678238</td></tr><tr><td>2.2278867046136734</td></tr><tr><td>3.331427296520743</td></tr><tr><td>2.4183012913197452</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>3.00987563371216</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.8325089127062364</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>0.0</td></tr><tr><td>2.934498451243568</td></tr><tr><td>1.6720978579357175</td></tr><tr><td>2.639486489268586</td></tr><tr><td>1.8920946026904804</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.8195439355418688</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.250420002308894</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.0791812460476249</td></tr><tr><td>1.9822712330395684</td></tr><tr><td>3.6637951222194074</td></tr><tr><td>0.0</td></tr><tr><td>0.0</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.0453229787866576</td></tr><tr><td>1.9138138523837167</td></tr><tr><td>2.041392685158225</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.9395192526186185</td></tr><tr><td>3.4328090050331683</td></tr><tr><td>1.7075701760979363</td></tr><tr><td>1.1139433523068367</td></tr><tr><td>2.1367205671564067</td></tr><tr><td>3.2830749747354715</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.6232492903979006</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.845098040014257</td></tr><tr><td>2.294466226161593</td></tr><tr><td>2.250420002308894</td></tr><tr><td>2.8609366207000937</td></tr><tr><td>3.331832044436249</td></tr><tr><td>2.798650645445269</td></tr><tr><td>2.1789769472931693</td></tr><tr><td>1.662757831681574</td></tr><tr><td>1.3222192947339193</td></tr><tr><td>1.146128035678238</td></tr><tr><td>3.229169702539101</td></tr><tr><td>1.8325089127062364</td></tr><tr><td>1.6434526764861874</td></tr><tr><td>1.255272505103306</td></tr><tr><td>1.6812412373755872</td></tr><tr><td>2.7589118923979736</td></tr><tr><td>1.146128035678238</td></tr><tr><td>0.7781512503836436</td></tr><tr><td>2.887617300335736</td></tr><tr><td>1.0413926851582251</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>1.4471580313422192</td></tr><tr><td>0.0</td></tr><tr><td>2.296665190261531</td></tr><tr><td>3.325925955771466</td></tr><tr><td>2.6503075231319366</td></tr><tr><td>0.0</td></tr><tr><td>2.568201724066995</td></tr><tr><td>1.8750612633917</td></tr><tr><td>1.5563025007672873</td></tr><tr><td>1.3010299956639813</td></tr><tr><td>3.231214647962601</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>2.9532763366673045</td></tr><tr><td>2.5563025007672873</td></tr><tr><td>0.0</td></tr><tr><td>1.9242792860618816</td></tr><tr><td>1.414973347970818</td></tr><tr><td>2.12057393120585</td></tr><tr><td>1.3979400086720377</td></tr><tr><td>2.788168371141168</td></tr><tr><td>0.9030899869919435</td></tr><tr><td>1.6812412373755872</td></tr><tr><td>2.1760912590556813</td></tr><tr><td>2.0755469613925306</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>0.6989700043360189</td></tr><tr><td>1.8864907251724818</td></tr><tr><td>2.387389826338729</td></tr><tr><td>3.1095785469043866</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>3.5945030438200893</td></tr><tr><td>2.7701152947871015</td></tr><tr><td>0.0</td></tr><tr><td>1.4313637641589874</td></tr><tr><td>2.606381365110605</td></tr><tr><td>2.1818435879447726</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.1172712956557644</td></tr><tr><td>3.3942765267678214</td></tr><tr><td>2.0644579892269186</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>0.3010299956639812</td></tr><tr><td>2.3654879848909</td></tr><tr><td>2.3521825181113627</td></tr><tr><td>2.94546858513182</td></tr><tr><td>1.968482948553935</td></tr><tr><td>1.414973347970818</td></tr><tr><td>0.6020599913279624</td></tr><tr><td>1.1760912590556813</td></tr><tr><td>1.255272505103306</td></tr><tr><td>0.0</td></tr><tr><td>0.47712125471966244</td></tr><tr><td>2.161368002234975</td></tr><tr><td>2.2041199826559246</td></tr><tr><td>1.662757831681574</td></tr><tr><td>1.5563025007672873</td></tr><tr><td>0.0</td></tr><tr><td>1.9912260756924949</td></tr><tr><td>1.792391689498254</td></tr><tr><td>2.0293837776852097</td></tr><tr><td>1.3617278360175928</td></tr><tr><td>1.6334684555795864</td></tr><tr><td>2.0791812460476247</td></tr></tbody></table></div>"]}}],"execution_count":8},{"cell_type":"code","source":["#deleting files due to limit... Free account sucks (Not anymore on 10172018)\n#After importing data to table, deleted most of uploaded data.\n#dbutils.fs.rm(\"/FileStore/tables/play_log_2/all_play_log_split1\")\n#display(dbutils.fs.ls(\"/FileStore/tables/play_log_2\"))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>path</th><th>name</th><th>size</th></tr></thead><tbody><tr><td>dbfs:/FileStore/tables/all_down_log</td><td>all_down_log</td><td>473836269</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split1</td><td>all_play_log_split1</td><td>1643216994</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split2</td><td>all_play_log_split2</td><td>1632073383</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split3</td><td>all_play_log_split3</td><td>1628458355</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split4</td><td>all_play_log_split4</td><td>1632235350</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split5</td><td>all_play_log_split5</td><td>1628481443</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split6</td><td>all_play_log_split6</td><td>1629369907</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split7</td><td>all_play_log_split7</td><td>1063598005</td></tr><tr><td>dbfs:/FileStore/tables/all_search_log_2</td><td>all_search_log_2</td><td>772075169</td></tr><tr><td>dbfs:/FileStore/tables/uid_count__2-d28d4.csv</td><td>uid_count__2-d28d4.csv</td><td>7806349</td></tr></tbody></table></div>"]}}],"execution_count":9},{"cell_type":"code","source":["#Can use pandas by converting to pandas dataframe\nuc_pd=uid_count.toPandas()\nuc_pd['count']=uc_pd['count'].astype(int)\nnp.log10(uc_pd['count']).plot.hist(bins=np.arange(0,5,0.2))\nplt.xlabel(\"user # plays (10^n)\")\n#use display to show the plot\ndisplay()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"image/png":["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"]}}],"execution_count":10},{"cell_type":"code","source":["uc_pd.dtypes"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">34</span><span class=\"ansired\">]: </span>\ncount     int64\nuid      object\ndtype: object\n</div>"]}}],"execution_count":11},{"cell_type":"code","source":["top_count_threshold = np.percentile(uc_pd['count'],99.9)\nprint(top_count_threshold)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">5195.394\n</div>"]}}],"execution_count":12},{"cell_type":"code","source":["print(\"total number of users:\",len(uc_pd['uid']))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">total number of users: 594735\n</div>"]}}],"execution_count":13},{"cell_type":"code","source":["# remove bots: get id with play counts>top_count_threshold\nid_list_bot = np.array(uc_pd['uid'][uc_pd['count']>top_count_threshold].dropna())"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":14},{"cell_type":"code","source":["print(\"total number of bot users:\",len(id_list_bot))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">total number of bot users: 595\n</div>"]}}],"execution_count":15},{"cell_type":"code","source":["id_list_bot"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">27</span><span class=\"ansired\">]: </span>\narray([&apos;0&apos;, &apos;101481979&apos;, &apos;1062806&apos;, &apos;11888894&apos;, &apos;1342999&apos;, &apos;140051345&apos;,\n       &apos;143354596&apos;, &apos;144491699&apos;, &apos;145321913&apos;, &apos;153049341&apos;, &apos;153955565&apos;,\n       &apos;155002031&apos;, &apos;155180961&apos;, &apos;155948236&apos;, &apos;157350081&apos;, &apos;159005310&apos;,\n       &apos;160326945&apos;, &apos;163276721&apos;, &apos;163693838&apos;, &apos;164682609&apos;, &apos;16517426&apos;,\n       &apos;165313253&apos;, &apos;165868343&apos;, &apos;166309355&apos;, &apos;167321380&apos;, &apos;167444175&apos;,\n       &apos;167444472&apos;, &apos;167481248&apos;, &apos;167569592&apos;, &apos;167569705&apos;, &apos;167575700&apos;,\n       &apos;167575915&apos;, &apos;167580487&apos;, &apos;167581388&apos;, &apos;167583388&apos;, &apos;167588887&apos;,\n       &apos;167590283&apos;, &apos;167593929&apos;, &apos;167596105&apos;, &apos;167599426&apos;, &apos;167612579&apos;,\n       &apos;167615175&apos;, &apos;167623036&apos;, &apos;167627217&apos;, &apos;167635385&apos;, &apos;167650457&apos;,\n       &apos;167659954&apos;, &apos;167661205&apos;, &apos;167671961&apos;, &apos;167677847&apos;, &apos;167680970&apos;,\n       &apos;167682858&apos;, &apos;167683586&apos;, &apos;167690625&apos;, &apos;167693697&apos;, &apos;167695938&apos;,\n       &apos;167696239&apos;, &apos;167700210&apos;, &apos;167704534&apos;, &apos;167706643&apos;, &apos;167707280&apos;,\n       &apos;167712044&apos;, &apos;167713541&apos;, &apos;167713797&apos;, &apos;167718052&apos;, &apos;167719673&apos;,\n       &apos;167725392&apos;, &apos;167726056&apos;, &apos;167727310&apos;, &apos;167728979&apos;, &apos;167730085&apos;,\n       &apos;167730143&apos;, &apos;167731023&apos;, &apos;167731140&apos;, &apos;167732720&apos;, &apos;167737147&apos;,\n       &apos;167737436&apos;, &apos;167742379&apos;, &apos;167742872&apos;, &apos;167743406&apos;, &apos;167745219&apos;,\n       &apos;167745641&apos;, &apos;167747112&apos;, &apos;167747124&apos;, &apos;167747801&apos;, &apos;167754070&apos;,\n       &apos;167754128&apos;, &apos;167758421&apos;, &apos;167760262&apos;, &apos;167761925&apos;, &apos;167764016&apos;,\n       &apos;167764386&apos;, &apos;167777254&apos;, &apos;167783472&apos;, &apos;167785168&apos;, &apos;167786598&apos;,\n       &apos;167787704&apos;, &apos;167790485&apos;, &apos;167791269&apos;, &apos;167791348&apos;, &apos;167793354&apos;,\n       &apos;167794981&apos;, &apos;167796612&apos;, &apos;167801352&apos;, &apos;167804677&apos;, &apos;167805845&apos;,\n       &apos;167806444&apos;, &apos;167806662&apos;, &apos;167808656&apos;, &apos;167810054&apos;, &apos;167810787&apos;,\n       &apos;167811710&apos;, &apos;167813752&apos;, &apos;167813920&apos;, &apos;167818016&apos;, &apos;167819222&apos;,\n       &apos;167819715&apos;, &apos;167822937&apos;, &apos;167823438&apos;, &apos;167825436&apos;, &apos;167825815&apos;,\n       &apos;167827154&apos;, &apos;167829148&apos;, &apos;167844226&apos;, &apos;167844390&apos;, &apos;167845797&apos;,\n       &apos;167846014&apos;, &apos;167846506&apos;, &apos;167848272&apos;, &apos;167848561&apos;, &apos;167851784&apos;,\n       &apos;167851974&apos;, &apos;167853900&apos;, &apos;167854344&apos;, &apos;167854923&apos;, &apos;167855341&apos;,\n       &apos;167859257&apos;, &apos;167860378&apos;, &apos;167880223&apos;, &apos;167884496&apos;, &apos;167885946&apos;,\n       &apos;167887640&apos;, &apos;167889781&apos;, &apos;167890130&apos;, &apos;167897371&apos;, &apos;167899014&apos;,\n       &apos;167899059&apos;, &apos;167902375&apos;, &apos;167904025&apos;, &apos;167904482&apos;, &apos;1679121&apos;,\n       &apos;167912507&apos;, &apos;167913565&apos;, &apos;167916385&apos;, &apos;167917265&apos;, &apos;167918394&apos;,\n       &apos;167921862&apos;, &apos;167924511&apos;, &apos;167929048&apos;, &apos;167929584&apos;, &apos;167932009&apos;,\n       &apos;167932708&apos;, &apos;167935879&apos;, &apos;167944575&apos;, &apos;167944831&apos;, &apos;167946050&apos;,\n       &apos;167946332&apos;, &apos;167946866&apos;, &apos;167949218&apos;, &apos;167953798&apos;, &apos;167957776&apos;,\n       &apos;167958871&apos;, &apos;167961590&apos;, &apos;167962526&apos;, &apos;167967381&apos;, &apos;167967861&apos;,\n       &apos;167968136&apos;, &apos;167968635&apos;, &apos;167972364&apos;, &apos;167982849&apos;, &apos;167983311&apos;,\n       &apos;167983836&apos;, &apos;167986096&apos;, &apos;167990437&apos;, &apos;167993538&apos;, &apos;167999540&apos;,\n       &apos;168000279&apos;, &apos;168002623&apos;, &apos;168004270&apos;, &apos;168006130&apos;, &apos;168010312&apos;,\n       &apos;168011385&apos;, &apos;168011993&apos;, &apos;168012910&apos;, &apos;168013316&apos;, &apos;168031437&apos;,\n       &apos;168032345&apos;, &apos;168032406&apos;, &apos;168034837&apos;, &apos;168035646&apos;, &apos;168038209&apos;,\n       &apos;168038272&apos;, &apos;168041585&apos;, &apos;168046345&apos;, &apos;168052175&apos;, &apos;168053025&apos;,\n       &apos;168056157&apos;, &apos;168056334&apos;, &apos;168057360&apos;, &apos;168057715&apos;, &apos;168060428&apos;,\n       &apos;168064490&apos;, &apos;168065114&apos;, &apos;168065328&apos;, &apos;168066379&apos;, &apos;168069360&apos;,\n       &apos;168072772&apos;, &apos;168077474&apos;, &apos;168077666&apos;, &apos;168093388&apos;, &apos;168099619&apos;,\n       &apos;168118618&apos;, &apos;168119842&apos;, &apos;168121258&apos;, &apos;168123199&apos;, &apos;168125418&apos;,\n       &apos;168125504&apos;, &apos;168127634&apos;, &apos;168128248&apos;, &apos;168129488&apos;, &apos;168131933&apos;,\n       &apos;168135839&apos;, &apos;168140293&apos;, &apos;168142391&apos;, &apos;168142784&apos;, &apos;168145447&apos;,\n       &apos;168150668&apos;, &apos;168153849&apos;, &apos;168156961&apos;, &apos;168160117&apos;, &apos;168162754&apos;,\n       &apos;168168449&apos;, &apos;168170398&apos;, &apos;168174656&apos;, &apos;168178214&apos;, &apos;168179842&apos;,\n       &apos;168184305&apos;, &apos;168187378&apos;, &apos;168192825&apos;, &apos;168195670&apos;, &apos;168196218&apos;,\n       &apos;168197546&apos;, &apos;168197843&apos;, &apos;168199420&apos;, &apos;168199748&apos;, &apos;168201483&apos;,\n       &apos;168202392&apos;, &apos;168202560&apos;, &apos;168203060&apos;, &apos;168203420&apos;, &apos;168213863&apos;,\n       &apos;168216084&apos;, &apos;168222412&apos;, &apos;168225378&apos;, &apos;168230090&apos;, &apos;168231576&apos;,\n       &apos;168232514&apos;, &apos;168240746&apos;, &apos;168241191&apos;, &apos;168246343&apos;, &apos;168248662&apos;,\n       &apos;168249045&apos;, &apos;168250614&apos;, &apos;168250921&apos;, &apos;168251426&apos;, &apos;168254989&apos;,\n       &apos;168255004&apos;, &apos;168265762&apos;, &apos;168268235&apos;, &apos;168269508&apos;, &apos;168269925&apos;,\n       &apos;168270605&apos;, &apos;168274215&apos;, &apos;168276011&apos;, &apos;168279374&apos;, &apos;168281676&apos;,\n       &apos;168283336&apos;, &apos;168284154&apos;, &apos;168285039&apos;, &apos;168287265&apos;, &apos;168297036&apos;,\n       &apos;168302212&apos;, &apos;168302407&apos;, &apos;168302633&apos;, &apos;168305379&apos;, &apos;168308107&apos;,\n       &apos;168308643&apos;, &apos;168309076&apos;, &apos;168311257&apos;, &apos;168311610&apos;, &apos;168314869&apos;,\n       &apos;168322120&apos;, &apos;1683241&apos;, &apos;168328442&apos;, &apos;168329934&apos;, &apos;168331901&apos;,\n       &apos;168334631&apos;, &apos;168342661&apos;, &apos;168343089&apos;, &apos;168352055&apos;, &apos;168353633&apos;,\n       &apos;168354109&apos;, &apos;168355528&apos;, &apos;168355686&apos;, &apos;168358222&apos;, &apos;168361375&apos;,\n       &apos;168366433&apos;, &apos;168369354&apos;, &apos;168369649&apos;, &apos;168372570&apos;, &apos;168377676&apos;,\n       &apos;168385387&apos;, &apos;168389247&apos;, &apos;168390806&apos;, &apos;168401205&apos;, &apos;168402382&apos;,\n       &apos;168402486&apos;, &apos;168403831&apos;, &apos;168403872&apos;, &apos;168412286&apos;, &apos;168412815&apos;,\n       &apos;168414339&apos;, &apos;168415404&apos;, &apos;168416063&apos;, &apos;168418837&apos;, &apos;168421506&apos;,\n       &apos;168426073&apos;, &apos;168427097&apos;, &apos;168427689&apos;, &apos;168427707&apos;, &apos;168430027&apos;,\n       &apos;168433024&apos;, &apos;168433901&apos;, &apos;168442875&apos;, &apos;168444017&apos;, &apos;168447522&apos;,\n       &apos;168449112&apos;, &apos;168449518&apos;, &apos;168455882&apos;, &apos;168457034&apos;, &apos;168458969&apos;,\n       &apos;168462923&apos;, &apos;168468063&apos;, &apos;168471434&apos;, &apos;168471621&apos;, &apos;168472236&apos;,\n       &apos;168475531&apos;, &apos;168479014&apos;, &apos;168485003&apos;, &apos;168486395&apos;, &apos;168486648&apos;,\n       &apos;168490493&apos;, &apos;168494879&apos;, &apos;168495242&apos;, &apos;168496384&apos;, &apos;168497879&apos;,\n       &apos;168504753&apos;, &apos;168507580&apos;, &apos;168510160&apos;, &apos;168511018&apos;, &apos;168511655&apos;,\n       &apos;1685126&apos;, &apos;168512761&apos;, &apos;168513465&apos;, &apos;168516452&apos;, &apos;168516836&apos;,\n       &apos;168528820&apos;, &apos;168530548&apos;, &apos;168530803&apos;, &apos;168533031&apos;, &apos;168534129&apos;,\n       &apos;168534188&apos;, &apos;168535228&apos;, &apos;168535869&apos;, &apos;168539309&apos;, &apos;168539380&apos;,\n       &apos;168541943&apos;, &apos;168542503&apos;, &apos;168545848&apos;, &apos;168554329&apos;, &apos;168554770&apos;,\n       &apos;168560934&apos;, &apos;168564593&apos;, &apos;168565798&apos;, &apos;168577803&apos;, &apos;168578388&apos;,\n       &apos;168579556&apos;, &apos;168585274&apos;, &apos;168588804&apos;, &apos;168595606&apos;, &apos;168599098&apos;,\n       &apos;168600735&apos;, &apos;168602486&apos;, &apos;168606686&apos;, &apos;168607092&apos;, &apos;168607369&apos;,\n       &apos;168608036&apos;, &apos;168609992&apos;, &apos;168616926&apos;, &apos;168639534&apos;, &apos;168641844&apos;,\n       &apos;168645368&apos;, &apos;168646834&apos;, &apos;168649277&apos;, &apos;168651570&apos;, &apos;168653717&apos;,\n       &apos;168654194&apos;, &apos;168656161&apos;, &apos;168656437&apos;, &apos;168657859&apos;, &apos;168661974&apos;,\n       &apos;168663284&apos;, &apos;168668794&apos;, &apos;168668878&apos;, &apos;168674332&apos;, &apos;168674358&apos;,\n       &apos;168675238&apos;, &apos;168677944&apos;, &apos;168679433&apos;, &apos;168680315&apos;, &apos;168681408&apos;,\n       &apos;168684299&apos;, &apos;168695081&apos;, &apos;168698948&apos;, &apos;168702336&apos;, &apos;168704538&apos;,\n       &apos;168707925&apos;, &apos;168707975&apos;, &apos;168714069&apos;, &apos;168723654&apos;, &apos;168736411&apos;,\n       &apos;168739868&apos;, &apos;168743153&apos;, &apos;168745077&apos;, &apos;168746426&apos;, &apos;168750987&apos;,\n       &apos;168751924&apos;, &apos;168753899&apos;, &apos;168754788&apos;, &apos;168754908&apos;, &apos;168755405&apos;,\n       &apos;168761159&apos;, &apos;168766517&apos;, &apos;168772034&apos;, &apos;168777837&apos;, &apos;168778580&apos;,\n       &apos;168778891&apos;, &apos;168779843&apos;, &apos;168780369&apos;, &apos;168788690&apos;, &apos;168798094&apos;,\n       &apos;168798100&apos;, &apos;168798350&apos;, &apos;168800833&apos;, &apos;168804889&apos;, &apos;168805999&apos;,\n       &apos;168806797&apos;, &apos;168808021&apos;, &apos;168808366&apos;, &apos;168810075&apos;, &apos;168812339&apos;,\n       &apos;168813444&apos;, &apos;168814645&apos;, &apos;168821125&apos;, &apos;168824576&apos;, &apos;168825687&apos;,\n       &apos;168832642&apos;, &apos;168839489&apos;, &apos;168839717&apos;, &apos;168840935&apos;, &apos;168840940&apos;,\n       &apos;168841473&apos;, &apos;168847392&apos;, &apos;168849784&apos;, &apos;168854199&apos;, &apos;168860038&apos;,\n       &apos;168860398&apos;, &apos;168860519&apos;, &apos;168860860&apos;, &apos;168868255&apos;, &apos;168869244&apos;,\n       &apos;168869626&apos;, &apos;168870843&apos;, &apos;168871557&apos;, &apos;168877387&apos;, &apos;168878624&apos;,\n       &apos;168880241&apos;, &apos;168882509&apos;, &apos;168884001&apos;, &apos;168888831&apos;, &apos;168890770&apos;,\n       &apos;168894729&apos;, &apos;168902300&apos;, &apos;168904151&apos;, &apos;168906493&apos;, &apos;168907122&apos;,\n       &apos;168909971&apos;, &apos;168909986&apos;, &apos;168912937&apos;, &apos;168913248&apos;, &apos;168915463&apos;,\n       &apos;168921488&apos;, &apos;168922214&apos;, &apos;168923438&apos;, &apos;168923652&apos;, &apos;168923951&apos;,\n       &apos;168930795&apos;, &apos;168930967&apos;, &apos;168936919&apos;, &apos;168937105&apos;, &apos;168949110&apos;,\n       &apos;168952548&apos;, &apos;168952740&apos;, &apos;168960306&apos;, &apos;168965697&apos;, &apos;168967368&apos;,\n       &apos;168972294&apos;, &apos;168973024&apos;, &apos;168976529&apos;, &apos;168979440&apos;, &apos;168987982&apos;,\n       &apos;168989233&apos;, &apos;168992483&apos;, &apos;168992517&apos;, &apos;168993659&apos;, &apos;168995485&apos;,\n       &apos;169002956&apos;, &apos;169005367&apos;, &apos;169005666&apos;, &apos;169007066&apos;, &apos;169010686&apos;,\n       &apos;169011199&apos;, &apos;169012705&apos;, &apos;169015801&apos;, &apos;169019026&apos;, &apos;169021451&apos;,\n       &apos;169022080&apos;, &apos;169022968&apos;, &apos;169024129&apos;, &apos;169025131&apos;, &apos;169028588&apos;,\n       &apos;169031917&apos;, &apos;169034532&apos;, &apos;169040106&apos;, &apos;169118165&apos;, &apos;169245024&apos;,\n       &apos;1710083&apos;, &apos;1749320&apos;, &apos;17612166&apos;, &apos;1791497&apos;, &apos;18723671&apos;, &apos;1963913&apos;,\n       &apos;22730453&apos;, &apos;27954505&apos;, &apos;28638487&apos;, &apos;32104145&apos;, &apos;32166203&apos;,\n       &apos;34880977&apos;, &apos;37025504&apos;, &apos;41505048&apos;, &apos;42159585&apos;, &apos;42236906&apos;,\n       &apos;45312687&apos;, &apos;45365429&apos;, &apos;45621541&apos;, &apos;45888463&apos;, &apos;46532274&apos;,\n       &apos;497685&apos;, &apos;533817&apos;, &apos;53685604&apos;, &apos;56734540&apos;, &apos;57820269&apos;, &apos;60786265&apos;,\n       &apos;6217429&apos;, &apos;62692715&apos;, &apos;637650&apos;, &apos;64268006&apos;, &apos;65116455&apos;, &apos;69546515&apos;,\n       &apos;71914808&apos;, &apos;736305&apos;, &apos;751824&apos;, &apos;924065&apos;, &apos;93185093&apos;, &apos;94611842&apos;], dtype=object)\n</div>"]}}],"execution_count":16},{"cell_type":"code","source":["#Make things easy first, take out useful features, build new dataframe."],"metadata":{},"outputs":[],"execution_count":17},{"cell_type":"code","source":["all_down = spark.table(\"all_down_log\")\nall_search=spark.table(\"all_search_log\")\nall_play=spark.table(\"all_play_log_split1\")\nplay_split_name=['all_play_log_split2','all_play_log_split3','all_play_log_split4','all_play_log_split5','all_play_log_split6','all_play_log_split7']\nfor f in play_split_name:\n  all_play = all_play.union(spark.table(f))\n"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":18},{"cell_type":"code","source":["all_play.describe().show()\n#Took 17.6 mins to run, and results are not useful at all..."],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+--------------------+-------------------+--------------------+----------------+---------+--------------------+------------------+------------------+--------------------+--------------------+\nsummary|                 uid|             device|             song_id|       song_type|song_name|              singer|         play_time|       song_length|           paid_flag|                date|\n+-------+--------------------+-------------------+--------------------+----------------+---------+--------------------+------------------+------------------+--------------------+--------------------+\n  count|           146336075|          146377228|           146332944|       146240111|146339392|           146160249|         146096091|         146147988|           146164516|           146164516|\n   mean|1.3123151795991325E8|        2.1073897E7|1.280850570253911...|        Infinity| Infinity|2.597079040274338...|242170.99066907607| -76.6587169911947|0.006409978437536702|2.0170011812196404E7|\n stddev| 6.713896241357763E7|5.960533418916731E7|3.800600723101624E16|             NaN|      NaN|6.528769863327131E13|5.54750039469266E8|1102651.7002403848|  1.6033067039386535|   91516.78499433208|\n    min|!\u0014\u0011=]91=\u0005\u00101...|                |                  -1|                |        \u0001|\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001\u0001|                 \t|                 \t|              &quot;\t&quot;128|            20170330|\n    max|\u000E5Ij...|                 |               | _ DJ|       |          |               |        Rihanna|           Party boy|                |\n+-------+--------------------+-------------------+--------------------+----------------+---------+--------------------+------------------+------------------+--------------------+--------------------+\n\n</div>"]}}],"execution_count":19},{"cell_type":"code","source":["all_play.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+---------+------+--------+---------+--------------------+------------+---------+-----------+---------+---------+\n      uid|device| song_id|song_type|           song_name|      singer|play_time|song_length|paid_flag|     date|\n+---------+------+--------+---------+--------------------+------------+---------+-----------+---------+---------+\n168550892|    ar|23491655|        0|                  |         |      254|        254|       0 | 20170330|\n168540455|    ar|  298250|        0|       See You Again| Miley Cyrus|      189|        190|       0 | 20170330|\n168551247|    ar|11881432|        0|                |        |       78|        149|       0 | 20170330|\n168549788|    ip|  295469|        0|                 |         |       16|        242|       0 | 20170330|\n168551248|    ip|21393368|        0|           Intro|       |       87|         87|       0 | 20170330|\n168550496|    ar|12495422|        0|        |     3D|      369|       2747|       0 | 20170330|\n168551331|    ar|20671171|        0|        Shape Of You|  Ed Sheeran|      231|        231|       0 | 20170330|\n168535490|    ar| 6616004|        0|          (DJ)|        DJ|      283|        283|       0 | 20170330|\n168539760|    ar| 4732048|        0| ( Dj Pw Remix)|        |      197|        198|       0 | 20170330|\n168551373|    ar| 3378911|        0|                |         |       14|        212|       0 | 20170330|\n168544926|    ar| 4403788|        0|        |          |        6|         28|       0 | 20170330|\n168551042|    ar|  505355|        0|               |        |      106|        277|       0 | 20170330|\n168551026|    ar|19477157|        0|           |        |        2|         31|       0 | 20170330|\n168532580|    ar|21762903|        0|          (Live)|         |       67|        137|       0 | 20170330|\n168551417|    ar|  727161|        0|       A.I.N.Y. ()|   G.E.M.|       27|        226|       0 | 20170330|\n168551430|    ar| 1179220|        0|     Outlaws Of Love|Adam Lambert|      231|        231|       0 | 20170330|\n168540348|    ar|   77260|        0|  -()|         |    64528|          0|       0 | 20170330|\n168550728|    ar|  285233|        0|          Pretty Boy|         M2M|      282|        282|       0 | 20170330|\n168551156|    ar|  313037|        0|            |         |        0|        274|       0 | 20170330|\n168530895|    ar|       0|        1|Crave(Alex Presto...|Dia Frampton|      264|        265|       0 | 20170330|\n+---------+------+--------+---------+--------------------+------------+---------+-----------+---------+---------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":20},{"cell_type":"code","source":["all_down.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+----------+------+--------+--------------------+--------------------+---------+---------+\n       uid|device| song_id|           song_name|              singer|paid_flag|     date|\n+----------+------+--------+--------------------+--------------------+---------+---------+\n168019810 |   ar | 442554 |                 |            &amp; |       0 | 20170330|\n168019810 |   ar |6334611 |                 |                  |       0 | 20170330|\n168019810 |   ar |9867382 |                  |                  |       0 | 20170330|\n168019810 |   ar |6660691 |-() |                 |       0 | 20170330|\n168019810 |   ar | 157606 |               |                 |       0 | 20170330|\n168019810 |   ar |3372481 |        (OT) |                 |       0 | 20170330|\n168019810 |   ar |3216525 |      (Live) |                 |       0 | 20170330|\n168019810 |   ar |6427523 |            Victory |Two Steps From Hell |       0 | 20170330|\n168019810 |   ar |6538686 |                  |                 |       0 | 20170330|\n168019810 |   ar |9327383 |-[](...|           RADWIMPS |       0 | 20170330|\n168019810 |   ar |6716077 |-(...|                 |       0 | 20170330|\n168019810 |   ar | 350052 |                |                 |       0 | 20170330|\n168019810 |   ar |3638735 |               |                  |       0 | 20170330|\n168019810 |   ar | 409466 |       AlwaysOnline |                 |       0 | 20170330|\n168019810 |   ar |1076725 |Change The World(...|                 V6 |       0 | 20170330|\n168019810 |   ar |7130410 | Kyoto(Feat. Sirah) |           Skrillex |       0 | 20170330|\n168019810 |   ar | 912614 |               |              &amp; |       0 | 20170330|\n168019810 |   ar |3654821 |                  |                  |       0 | 20170330|\n168050395 |   ar |6544560 |Let&apos;s Not Fall In...|            BIGBANG |       0 | 20170330|\n168019810 |   ar |6673573 |  What Do You Mean |      Justin Bieber |       0 | 20170330|\n+----------+------+--------+--------------------+--------------------+---------+---------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":21},{"cell_type":"code","source":["all_search.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+----------+------+--------------------+--------------------+---------+\n       uid|device|          time_stamp|        search_query|     date|\n+----------+------+--------------------+--------------------+---------+\n168050208 |   ar |2017-03-30 00:00:00 |%E5%87%A4%E5%87%B...| 20170330|\n167659521 |   ar |2017-03-30 00:00:01 | %E5%B0%8F%E6%B4%B2 | 20170330|\n168411725 |   ip |2017-03-30 00:00:01 |%e5%ae%b9%e4%b8%a...| 20170330|\n167852824 |   ar |2017-03-30 00:00:02 |%E9%83%BD%E6%98%A...| 20170330|\n168043780 |   ar |2017-03-30 00:00:02 |%E8%91%AB%E8%8A%A...| 20170330|\n168040163 |   ar |2017-03-30 00:00:03 |%E6%B3%B0%E5%89%A...| 20170330|\n167690057 |   ar |2017-03-30 00:00:04 |%E8%BD%A6%E7%AB%9...| 20170330|\n167858657 |   ar |2017-03-30 00:00:05 |%E7%83%AD%E6%83%8...| 20170330|\n168020662 |   ip |2017-03-30 00:00:05 |%e9%bb%84%e5%87%a...| 20170330|\n167776092 |   ar |2017-03-30 00:00:05 | %E6%B1%9F%E6%B8%B8 | 20170330|\n168010044 |   ar |2017-03-30 00:00:07 |%E6%88%91%E6%98%A...| 20170330|\n167990196 |   ar |2017-03-30 00:00:07 |2007%E5%BF%AB%E4%...| 20170330|\n160732524 |   ar |2017-03-30 00:00:07 |%E5%BC%A0%E9%9D%9...| 20170330|\n168045723 |   ar |2017-03-30 00:00:07 | %E9%98%BF%E6%9D%9C | 20170330|\n168053493 |   ar |2017-03-30 00:00:08 |%E7%BC%98%E4%BB%B...| 20170330|\n168026669 |   ar |2017-03-30 00:00:08 | %E6%AD%A5%E6%AD%A5 | 20170330|\n   736305 |   ar |2017-03-30 00:00:08 |%E4%B8%89%E5%AF%B...| 20170330|\n167780192 |   ar |2017-03-30 00:00:10 | %E7%8E%8B%E8%8F%B2 | 20170330|\n167662203 |   ar |2017-03-30 00:00:10 |%E7%9C%8B%E5%A4%A...| 20170330|\n167580388 |   ar |2017-03-30 00:00:10 |%E5%B0%8F%E6%83%8...| 20170330|\n+----------+------+--------------------+--------------------+---------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":22},{"cell_type":"code","source":["print(all_down.describe().show())"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-------+--------------------+-------+-----------------+------------------+------------------+------------------+--------------------+\nsummary|                 uid| device|          song_id|         song_name|            singer|         paid_flag|                date|\n+-------+--------------------+-------+-----------------+------------------+------------------+------------------+--------------------+\n  count|             7737423|7746630|          7746275|           6706057|           6685272|           7728215|             7728214|\n   mean|1.3888461228411347E8|   null| 5777998.28975385|          Infinity|44279.696177062375|2.6099924975265645|2.0170151499696955E7|\n stddev|6.1741672071246535E7|   null|6435874.617349792|               NaN| 904625.4956538787| 7255.646764598923|   71459.23129354206|\n    min|                   0| *NSYNC|               0 |                  |                  |          20170330|            20170330|\n    max|            99800656|     |          9999722|()|        |            |                  0 |\n+-------+--------------------+-------+-----------------+------------------+------------------+------------------+--------------------+\n\nNone\n</div>"]}}],"execution_count":23},{"cell_type":"code","source":["output_field_list_play = ['uid','device','song_id','date','play_time','song_length']\nall_play_1 = all_play.select(output_field_list_play)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":24},{"cell_type":"code","source":["#Save the selected features as table\nall_play_1.write.saveAsTable(\"all_play_1\")"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":25},{"cell_type":"code","source":["output_field_list_down = ['uid','device','song_id','date']\nall_down_1 = all_down.select(output_field_list_down)\noutput_field_list_search = ['uid','device','date']\nall_search_1 = all_search.select(output_field_list_search)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":26},{"cell_type":"code","source":["print('all down_1:'),all_down_1.show()\nprint('all search_1:'),all_search_1.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">all down_1:\n+----------+------+--------+---------+\n       uid|device| song_id|     date|\n+----------+------+--------+---------+\n168019810 |   ar | 442554 | 20170330|\n168019810 |   ar |6334611 | 20170330|\n168019810 |   ar |9867382 | 20170330|\n168019810 |   ar |6660691 | 20170330|\n168019810 |   ar | 157606 | 20170330|\n168019810 |   ar |3372481 | 20170330|\n168019810 |   ar |3216525 | 20170330|\n168019810 |   ar |6427523 | 20170330|\n168019810 |   ar |6538686 | 20170330|\n168019810 |   ar |9327383 | 20170330|\n168019810 |   ar |6716077 | 20170330|\n168019810 |   ar | 350052 | 20170330|\n168019810 |   ar |3638735 | 20170330|\n168019810 |   ar | 409466 | 20170330|\n168019810 |   ar |1076725 | 20170330|\n168019810 |   ar |7130410 | 20170330|\n168019810 |   ar | 912614 | 20170330|\n168019810 |   ar |3654821 | 20170330|\n168050395 |   ar |6544560 | 20170330|\n168019810 |   ar |6673573 | 20170330|\n+----------+------+--------+---------+\nonly showing top 20 rows\n\nall search_1:\n+----------+------+---------+\n       uid|device|     date|\n+----------+------+---------+\n168050208 |   ar | 20170330|\n167659521 |   ar | 20170330|\n168411725 |   ip | 20170330|\n167852824 |   ar | 20170330|\n168043780 |   ar | 20170330|\n168040163 |   ar | 20170330|\n167690057 |   ar | 20170330|\n167858657 |   ar | 20170330|\n168020662 |   ip | 20170330|\n167776092 |   ar | 20170330|\n168010044 |   ar | 20170330|\n167990196 |   ar | 20170330|\n160732524 |   ar | 20170330|\n168045723 |   ar | 20170330|\n168053493 |   ar | 20170330|\n168026669 |   ar | 20170330|\n   736305 |   ar | 20170330|\n167780192 |   ar | 20170330|\n167662203 |   ar | 20170330|\n167580388 |   ar | 20170330|\n+----------+------+---------+\nonly showing top 20 rows\n\n<span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>(None, None)\n</div>"]}}],"execution_count":27},{"cell_type":"code","source":["all_down_1.write.saveAsTable(\"all_down_1\")\nall_search_1.write.saveAsTable(\"all_search_1\")"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":28},{"cell_type":"code","source":["display(dbutils.fs.ls(\"/FileStore/tables/\"))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>path</th><th>name</th><th>size</th></tr></thead><tbody><tr><td>dbfs:/FileStore/tables/all_down_log</td><td>all_down_log</td><td>473836269</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split1</td><td>all_play_log_split1</td><td>1643216994</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split2</td><td>all_play_log_split2</td><td>1632073383</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split3</td><td>all_play_log_split3</td><td>1628458355</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split4</td><td>all_play_log_split4</td><td>1632235350</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split5</td><td>all_play_log_split5</td><td>1628481443</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split6</td><td>all_play_log_split6</td><td>1629369907</td></tr><tr><td>dbfs:/FileStore/tables/all_play_log_split7</td><td>all_play_log_split7</td><td>1063598005</td></tr><tr><td>dbfs:/FileStore/tables/all_search_log_2</td><td>all_search_log_2</td><td>772075169</td></tr><tr><td>dbfs:/FileStore/tables/uid_count__2-d28d4.csv</td><td>uid_count__2-d28d4.csv</td><td>7806349</td></tr></tbody></table></div>"]}}],"execution_count":29},{"cell_type":"code","source":["#Recovery after cluster termination\nall_play_1=spark.table('all_play_1')\nall_down_1=spark.table('all_down_1')\nall_search_1=spark.table('all_search_1')\nuid_count = spark.table(\"uid_count\")\nuc_pd=uid_count.toPandas()\nuc_pd['count']=uc_pd['count'].astype(int)\ntop_count_threshold = np.percentile(uc_pd['count'],99.9)\nid_list_bot = np.array(uc_pd['uid'][uc_pd['count']>top_count_threshold].dropna())"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":30},{"cell_type":"code","source":["all_play_1.select('date').show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+---------+\n     date|\n+---------+\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n 20170330|\n+---------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":31},{"cell_type":"code","source":["#one way to convert string to date\nspark.sql(\"SELECT to_date('201810018', 'yyyyMMdd')\").show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+--------------------------------+\nto_date(&apos;201810018&apos;, &apos;yyyyMMdd&apos;)|\n+--------------------------------+\n                      2018-10-18|\n+--------------------------------+\n\n</div>"]}}],"execution_count":32},{"cell_type":"code","source":["from pyspark.sql import functions as F\nfrom pyspark.sql.types import *\n#spark.sql(\"SELECT to_date('date', ' yyyyMMdd') FROM all_play_1\").show()\n#spark.sql(\"SELECT to_date(CAST(UNIX_TIMESTAMP('date', ' yyyyMMdd') AS TIMESTAMP)) from all_play_1\").show()\n\n#Be cautious with the space before the yyyyMMdd string, which caused me a lot of trouble figuring it out.\nall_play_1 = all_play_1.withColumn('date', F.to_date('date',' yyyyMMdd'))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":33},{"cell_type":"code","source":["all_play_1.dtypes"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">18</span><span class=\"ansired\">]: </span>\n[(&apos;uid&apos;, &apos;string&apos;),\n (&apos;device&apos;, &apos;string&apos;),\n (&apos;song_id&apos;, &apos;string&apos;),\n (&apos;date&apos;, &apos;date&apos;),\n (&apos;play_time&apos;, &apos;string&apos;),\n (&apos;song_length&apos;, &apos;string&apos;)]\n</div>"]}}],"execution_count":34},{"cell_type":"code","source":["all_play_1.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+---------+------+--------+----------+---------+-----------+\n      uid|device| song_id|      date|play_time|song_length|\n+---------+------+--------+----------+---------+-----------+\n168666043|    ar| 5068607|2017-03-30|        0|          0|\n168646665|    ip|18373139|2017-03-30|      121|        121|\n168648292|    ip|  104028|2017-03-30|        0|        230|\n168574445|    ar| 1026783|2017-03-30|      230|        230|\n168666387|    ip| 6402913|2017-03-30|        1|        185|\n168636936|    ar|20865252|2017-03-30|      428|        443|\n168666043|    ar|  359910|2017-03-30|        3|        227|\n168617835|    ar|  929972|2017-03-30|        0|          0|\n168579809|    ar| 9820714|2017-03-30|      216|        216|\n168659242|    ar|13360780|2017-03-30|      105|        273|\n168662873|    ar|  367995|2017-03-30|      201|        218|\n168630322|    ar| 7047038|2017-03-30|       40|        124|\n168666043|    ar|  112846|2017-03-30|        0|        215|\n168663665|    ar| 7187928|2017-03-30|      190|        209|\n168548197|    ar| 9929880|2017-03-30|        0|          0|\n168654698|    ar| 7118137|2017-03-30|      236|        236|\n168548197|    ar| 9919225|2017-03-30|        0|          0|\n168667879|    ar| 1238464|2017-03-30|      204|        205|\n168655554|    ar| 4990278|2017-03-30|       14|        203|\n168548197|    ar| 9919225|2017-03-30|        0|          0|\n+---------+------+--------+----------+---------+-----------+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":35},{"cell_type":"code","source":["all_down_1 = all_down_1.withColumn('date', F.to_date('date',' yyyyMMdd'))\nall_search_1 = all_search_1.withColumn('date', F.to_date('date',' yyyyMMdd'))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":36},{"cell_type":"code","source":["print(all_down_1.dtypes)\nprint(all_search_1.dtypes)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">[(&apos;uid&apos;, &apos;string&apos;), (&apos;device&apos;, &apos;string&apos;), (&apos;song_id&apos;, &apos;string&apos;), (&apos;date&apos;, &apos;date&apos;)]\n[(&apos;uid&apos;, &apos;string&apos;), (&apos;device&apos;, &apos;string&apos;), (&apos;date&apos;, &apos;date&apos;)]\n</div>"]}}],"execution_count":37},{"cell_type":"code","source":["#seems isin does not work with nparray\nid_list_bot_list=id_list_bot.tolist()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":38},{"cell_type":"code","source":["#Not going to downsample but still need to filter out bots. \n#id_list_bot\nall_play_1_bot_removed=all_play_1[(all_play_1.uid.isin(id_list_bot_list))==False]\n#Or all_play_1_bot_removed2=all_play_1[~(all_play_1.uid.isin(id_list_bot_list))]"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":39},{"cell_type":"code","source":["all_down_1_bot_removed=all_down_1[(all_down_1.uid.isin(id_list_bot_list))==False]\nall_search_1_bot_removed=all_search_1[(all_search_1.uid.isin(id_list_bot_list))==False]"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":40},{"cell_type":"code","source":["print(all_play_1_bot_removed.count(),all_play_1.count())\nprint(all_down_1_bot_removed.count(),all_down_1.count())\nprint(all_search_1_bot_removed.count(),all_search_1.count())"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">109121780 146377234\n6308786 7746631\n7787749 8640335\n</div>"]}}],"execution_count":41},{"cell_type":"code","source":["#Save as table\nall_play_1_bot_removed.write.saveAsTable(\"all_play_1_bot_removed\")\nall_down_1_bot_removed.write.saveAsTable(\"all_down_1_bot_removed\")\nall_search_1_bot_removed.write.saveAsTable(\"all_search_1_bot_removed\")"],"metadata":{},"outputs":[],"execution_count":42},{"cell_type":"code","source":["#After termination\nall_play_1_bot_removed=spark.table(\"all_play_1_bot_removed\")\nall_down_1_bot_removed=spark.table(\"all_down_1_bot_removed\")\nall_search_1_bot_removed=spark.table(\"all_search_1_bot_removed\")"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":43},{"cell_type":"markdown","source":["# Create event table for feature generation"],"metadata":{}},{"cell_type":"code","source":["from pyspark.sql.functions import *\n#Can only use literal. I don not really understand why.\n#https://stackoverflow.com/questions/32788322/how-to-add-a-constant-column-in-a-spark-dataframe\n#Does not even need to join, just use union.\noutput_field_list = ['uid','date','song_id']\nall_play_event=all_play_1_bot_removed.select(output_field_list)\nall_play_event=all_play_event.withColumn('event',lit('P'))\nall_down_event=all_down_1_bot_removed.select(output_field_list)\nall_down_event=all_down_event.withColumn('event',lit('D'))\nall_search_event=all_search_1_bot_removed.select(['uid','date'])\nall_search_event=all_search_event.withColumn('song_id',lit(' '))\nall_search_event=all_search_event.withColumn('event',lit('S'))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":45},{"cell_type":"code","source":["all_play_event.printSchema()\nall_down_event.printSchema()\nall_search_event.printSchema()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">root\n-- uid: string (nullable = true)\n-- date: date (nullable = true)\n-- song_id: string (nullable = true)\n-- event: string (nullable = false)\n\nroot\n-- uid: string (nullable = true)\n-- date: date (nullable = true)\n-- song_id: string (nullable = true)\n-- event: string (nullable = false)\n\nroot\n-- uid: string (nullable = true)\n-- date: date (nullable = true)\n-- song_id: string (nullable = false)\n-- event: string (nullable = false)\n\n</div>"]}}],"execution_count":46},{"cell_type":"code","source":["all_play_event.show()\nall_down_event.show()\nall_search_event.show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+---------+----------+--------+-----+\n      uid|      date| song_id|event|\n+---------+----------+--------+-----+\n168666043|2017-03-30| 5068607|    P|\n168646665|2017-03-30|18373139|    P|\n168648292|2017-03-30|  104028|    P|\n168574445|2017-03-30| 1026783|    P|\n168666387|2017-03-30| 6402913|    P|\n168636936|2017-03-30|20865252|    P|\n168666043|2017-03-30|  359910|    P|\n168617835|2017-03-30|  929972|    P|\n168579809|2017-03-30| 9820714|    P|\n168659242|2017-03-30|13360780|    P|\n168662873|2017-03-30|  367995|    P|\n168630322|2017-03-30| 7047038|    P|\n168666043|2017-03-30|  112846|    P|\n168663665|2017-03-30| 7187928|    P|\n168548197|2017-03-30| 9929880|    P|\n168654698|2017-03-30| 7118137|    P|\n168548197|2017-03-30| 9919225|    P|\n168667879|2017-03-30| 1238464|    P|\n168655554|2017-03-30| 4990278|    P|\n168548197|2017-03-30| 9919225|    P|\n+---------+----------+--------+-----+\nonly showing top 20 rows\n\n+----------+----------+--------+-----+\n       uid|      date| song_id|event|\n+----------+----------+--------+-----+\n168019810 |2017-03-30| 442554 |    D|\n168019810 |2017-03-30|6334611 |    D|\n168019810 |2017-03-30|9867382 |    D|\n168019810 |2017-03-30|6660691 |    D|\n168019810 |2017-03-30| 157606 |    D|\n168019810 |2017-03-30|3372481 |    D|\n168019810 |2017-03-30|3216525 |    D|\n168019810 |2017-03-30|6427523 |    D|\n168019810 |2017-03-30|6538686 |    D|\n168019810 |2017-03-30|9327383 |    D|\n168019810 |2017-03-30|6716077 |    D|\n168019810 |2017-03-30| 350052 |    D|\n168019810 |2017-03-30|3638735 |    D|\n168019810 |2017-03-30| 409466 |    D|\n168019810 |2017-03-30|1076725 |    D|\n168019810 |2017-03-30|7130410 |    D|\n168019810 |2017-03-30| 912614 |    D|\n168019810 |2017-03-30|3654821 |    D|\n168050395 |2017-03-30|6544560 |    D|\n168019810 |2017-03-30|6673573 |    D|\n+----------+----------+--------+-----+\nonly showing top 20 rows\n\n+---------+----------+-------+-----+\n      uid|      date|song_id|event|\n+---------+----------+-------+-----+\n168830619|2017-04-12|       |    S|\n168583621|2017-04-12|       |    S|\n168959645|2017-04-12|       |    S|\n 82677429|2017-04-12|       |    S|\n169003765|2017-04-12|       |    S|\n168716413|2017-04-12|       |    S|\n168945709|2017-04-12|       |    S|\n168945709|2017-04-12|       |    S|\n168685724|2017-04-12|       |    S|\n168716413|2017-04-12|       |    S|\n168657081|2017-04-12|       |    S|\n168793105|2017-04-12|       |    S|\n168793105|2017-04-12|       |    S|\n168829513|2017-04-12|       |    S|\n168829513|2017-04-12|       |    S|\n168752874|2017-04-12|       |    S|\n168765868|2017-04-12|       |    S|\n168793105|2017-04-12|       |    S|\n168973409|2017-04-12|       |    S|\n168713074|2017-04-12|       |    S|\n+---------+----------+-------+-----+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":47},{"cell_type":"code","source":["event_table=all_play_event.union(all_down_event).union(all_search_event)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":48},{"cell_type":"code","source":["event_table.printSchema()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">root\n-- uid: string (nullable = true)\n-- date: date (nullable = true)\n-- song_id: string (nullable = true)\n-- event: string (nullable = false)\n\n</div>"]}}],"execution_count":49},{"cell_type":"code","source":["#Make sure it is right.\nprint(all_play_event.count()+all_down_event.count()+all_search_event.count())\nprint(event_table.count())"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">123218315\n123218315\n</div>"]}}],"execution_count":50},{"cell_type":"code","source":["#Make sure the union works.\nevent_table[event_table['event']=='D'].show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+----------+----------+--------+-----+\n       uid|      date| song_id|event|\n+----------+----------+--------+-----+\n168019810 |2017-03-30| 442554 |    D|\n168019810 |2017-03-30|6334611 |    D|\n168019810 |2017-03-30|9867382 |    D|\n168019810 |2017-03-30|6660691 |    D|\n168019810 |2017-03-30| 157606 |    D|\n168019810 |2017-03-30|3372481 |    D|\n168019810 |2017-03-30|3216525 |    D|\n168019810 |2017-03-30|6427523 |    D|\n168019810 |2017-03-30|6538686 |    D|\n168019810 |2017-03-30|9327383 |    D|\n168019810 |2017-03-30|6716077 |    D|\n168019810 |2017-03-30| 350052 |    D|\n168019810 |2017-03-30|3638735 |    D|\n168019810 |2017-03-30| 409466 |    D|\n168019810 |2017-03-30|1076725 |    D|\n168019810 |2017-03-30|7130410 |    D|\n168019810 |2017-03-30| 912614 |    D|\n168019810 |2017-03-30|3654821 |    D|\n168050395 |2017-03-30|6544560 |    D|\n168019810 |2017-03-30|6673573 |    D|\n+----------+----------+--------+-----+\nonly showing top 20 rows\n\n</div>"]}}],"execution_count":51},{"cell_type":"code","source":["#Save as table\nevent_table.write.saveAsTable(\"event_table\")"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":52},{"cell_type":"code","source":[""],"metadata":{},"outputs":[],"execution_count":53}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":"3"},"version":"3.6.5","nbconvert_exporter":"python","file_extension":".py"},"name":"3_etl_down_sample_by_user","notebookId":2987614090499135},"nbformat":4,"nbformat_minor":0}
